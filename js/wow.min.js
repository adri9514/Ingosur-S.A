/*! WOW lite – Ingosur S.A. | reemplazo de wow.min.js (≈1KB) */
(function () {
  'use strict';

  var cfg = {
    boxClass: 'wow',
    animateClass: 'animated',
    offset: 0,           // px de “offset” por si quieres disparar antes
    mobile: true         // si false, no anima en móviles
  };

  var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  if (!cfg.mobile && isMobile) return;

  function prep(el, hide) {
    // Duración / delay / iteration desde data-attrs
    var dur = el.getAttribute('data-wow-duration');
    var del = el.getAttribute('data-wow-delay');
    var it  = el.getAttribute('data-wow-iteration');
    if (dur) el.style.animationDuration = dur;
    if (del) el.style.animationDelay = del;
    if (it)  el.style.animationIterationCount = it;
    el.style.visibility = hide ? 'hidden' : 'visible';
  }

  function boot() {
    var boxes = Array.prototype.slice.call(document.getElementsByClassName(cfg.boxClass));
    if (!boxes.length) return;

    // Preparar: oculto hasta que entren en viewport
    boxes.forEach(function (el) { prep(el, true); });

    // Fallback sin IntersectionObserver: mostrar todo
    if (!('IntersectionObserver' in window)) {
      boxes.forEach(function (el) {
        prep(el, false);
        el.classList.add(cfg.animateClass);
      });
      return;
    }

    var io = new IntersectionObserver(function (entries) {
      entries.forEach(function (ent) {
        if (!ent.isIntersecting) return;
        var el = ent.target;
        prep(el, false);
        if (!el.classList.contains(cfg.animateClass)) el.classList.add(cfg.animateClass);
        io.unobserve(el);
      });
    }, {
      root: null,
      threshold: 0.2,
      // dispara un poco antes si configuras offset>0
      rootMargin: '0px 0px -' + (cfg.offset || 0) + 'px 0px'
    });

    boxes.forEach(function (el) { io.observe(el); });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', boot);
  } else {
    boot();
  }
})();
